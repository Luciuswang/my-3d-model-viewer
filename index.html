<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<title>Lucius Wang — 3D 作品集</title>
<style>
  body{margin:0;background:#111;color:#fff;font-family:Arial,Helvetica,sans-serif;}
  h1{margin:0;padding:24px 16px;text-align:center;background:#000;font-size:24px;}
  .viewer{width:100%;height:500px;border:1px solid #444;margin-bottom:32px;}
</style>
</head>
<body>
<h1>3 D 模型预览</h1>
<div id="v1" class="viewer"></div>
<div id="v2" class="viewer"></div>
<div id="v3" class="viewer"></div>

<!-- **注意：type="module"** -->
<script type="module">
  /* ① 从 CDN 以 ES‑Module 方式引入 */
  import * as THREE from 'https://unpkg.com/three@0.156.1/build/three.module.js';
  import { OrbitControls } from 'https://unpkg.com/three@0.156.1/examples/jsm/controls/OrbitControls.js';
  import { FBXLoader    } from 'https://unpkg.com/three@0.156.1/examples/jsm/loaders/FBXLoader.js';

  /* ② 封装一个创建 Viewer 的函数（**注意不再写 THREE.OrbitControls**） */
  function createViewer(domId, fbxFile){
    const el = document.getElementById(domId);
    const w  = el.clientWidth, h = el.clientHeight;

    const scene = new THREE.Scene();
    scene.background = new THREE.Color(0x222222);

    const camera = new THREE.PerspectiveCamera(60, w/h, 0.1, 1000);
    camera.position.set(0, 100, 200);

    const renderer = new THREE.WebGLRenderer({antialias:true});
    renderer.setSize(w, h);
    renderer.setPixelRatio(window.devicePixelRatio);
    el.appendChild(renderer.domElement);

    scene.add(new THREE.AmbientLight(0xffffff, 0.6));
    const dl = new THREE.DirectionalLight(0xffffff, 0.8);
    dl.position.set(60,100,50);
    scene.add(dl);

    /* OrbitControls 直接用构造函数，不带 THREE. 前缀 */
    const controls = new OrbitControls(camera, renderer.domElement);
    controls.enableDamping = true;

    new FBXLoader().load(
      fbxFile,
      obj=>{
        // 自动缩放到合适大小
        const box = new THREE.Box3().setFromObject(obj);
        const size = box.getSize(new THREE.Vector3()).length();
        obj.scale.setScalar(120/size);
        scene.add(obj);
      },
      undefined,
      err=>console.error('加载 FBX 失败', err)
    );

    function animate(){
      requestAnimationFrame(animate);
      controls.update();
      renderer.render(scene, camera);
    }
    animate();

    /* 窗口大小变化自适应 */
    window.addEventListener('resize', ()=>{
      const w2 = el.clientWidth, h2 = el.clientHeight;
      camera.aspect = w2/h2;
      camera.updateProjectionMatrix();
      renderer.setSize(w2,h2);
    });
  }

  /* ③ 初始化三个模型 */
  createViewer('v1','model1.fbx');
  createViewer('v2','model2.fbx');
  createViewer('v3','model3.fbx');
</script>
</body>
</html>
